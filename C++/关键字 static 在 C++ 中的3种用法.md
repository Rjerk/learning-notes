# 关键字 static 在 C++ 中的3种用法

static 只能在对象的声明（除了在函数参数列表里），函数的声明（除了块作用域），以及匿名 union 的声明里出现。

当用在一个类成员里，它声明一个 static 成员；当用在一个对象的声明里，它指定了静态存储期；当被在名称空间里声明时，它指定了一个内部链接。

另外，使用 extern 但未初始化的一个变量声明不是一个定义。

## static 数据成员和成员函数

static 为类声明静态数据成员和静态成员函数。一个类的 static 成员和这个类的任何对象无关，它们是定义在名称空间中带有静态存储期或常规函数的独立对象，在程序中只存在一次。

- static 成员函数

static 成员函数不是每个对象的组成部分，而是存储在该类的所有对象之外。当被调用时，其上无 this 指针。

static 成员函数不能为 virtual、const 或 volatile。

一个 static 成员函数的地址可以被存储在常规的函数指针之内，但是不能存储在成员函数指针之内。

- static 数据成员

static 数据成员亦与任何对象无关。

static 数据成员不能是 mutable 。

## static 链接

C++ 中每个源文件都是独立编译，得到的对象文件要链接（linkage）在一起。C++ 源文件中的每个名字，包括函数和全局变量，都有一个链接，可能是内部链接，也可能是外部链接。

外部链接是指，对于其他源文件，这个名字是可用的。内部链接，也叫静态链接，指的是对于其他源文件，这个名字不可用。

函数和全局变量默认都有外部链接，但是可以在声明前面加上关键字 static，来指定内部（或静态）链接。

和 static 有个相关的关键字 extern，用来为位于它前面的名字声明外部链接。如 const 和 typedef 默认有内部链接，可以使用 extern 为其指定外部链接。

## 函数中的 static 变量

函数内部的静态变量就像是只能从该函数访问的全局变量一样，只在进入和退出函数作用域之间维护变量的值。